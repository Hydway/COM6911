Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
Environment:
	Python: 3.9.1
	PyTorch: 2.0.0+cu117
	Torchvision: 0.15.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.2
	PIL: 9.4.0
/home/acs22yq/.conda/envs/dgml/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/acs22yq/.conda/envs/dgml/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
=======hyper-parameter used========
==========================================
algorithm:MLDG
alpha:1
anneal_iters:500
batch_size:32
beta:1
beta1:0.5
bottleneck:256
checkpoint_freq:3
classifier:linear
data_file:
dataset:PACS
data_dir:../Data/PACS/
dis_hidden:256
disttype:2-norm
gpu_id:0
groupdro_eta:1
inner_lr:0.01
lam:1
layer:bn
lr:0.01
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
lr_gamma:0.0003
max_epoch:2
mixupalpha:0.2
mldg_beta:10.0
mmd_gamma:1
momentum:0.9
net:resnet18
N_WORKERS:1
rsc_f_drop_factor:0.3333333333333333
rsc_b_drop_factor:0.3333333333333333
save_model_every_checkpoint:False
schuse:False
schusech:cos
seed:0
split_style:strat
task:img_dg
tau:1
test_envs:[2]
output:../output/
weight_decay:0.0005
steps_per_epoch:100
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'office': ['amazon', 'dslr', 'webcam'], 'office-caltech': ['amazon', 'dslr', 'webcam', 'caltech'], 'office-home': ['Art', 'Clipart', 'Product', 'Real_World'], 'PACS': ['art_painting', 'cartoon', 'photo', 'sketch'], 'dg5': ['mnist', 'mnist_m', 'svhn', 'syn', 'usps'], 'VLCS': ['Caltech101', 'LabelMe', 'SUN09', 'VOC2007']}
input_shape:(3, 224, 224)
num_classes:7
domain_num:4

===========start training===========
===========epoch 0===========
total_loss:21.4107
train_acc:0.1634,valid_acc:0.1601,target_acc:0.1060
total cost time: 246.7194
manually descrease lr
===========epoch 1===========
total_loss:20.5861
train_acc:0.1481,valid_acc:0.1478,target_acc:0.1192
total cost time: 452.3231
valid acc: 0.1601
DG result: 0.1060
Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
Environment:
	Python: 3.9.1
	PyTorch: 2.0.0+cu117
	Torchvision: 0.15.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.2
	PIL: 9.4.0
/home/acs22yq/.conda/envs/dgml/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/acs22yq/.conda/envs/dgml/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
=======hyper-parameter used========
==========================================
algorithm:DIFEX
alpha:0.1
anneal_iters:500
batch_size:32
beta:0.01
beta1:0.5
bottleneck:256
checkpoint_freq:1
classifier:linear
data_file:
dataset:PACS
data_dir:../Data/PACS/
dis_hidden:256
disttype:2-norm
gpu_id:0
groupdro_eta:1
inner_lr:0.01
lam:0.1
layer:bn
lr:0.01
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
lr_gamma:0.0003
max_epoch:120
mixupalpha:0.2
mldg_beta:1
mmd_gamma:1
momentum:0.9
net:resnet18
N_WORKERS:1
rsc_f_drop_factor:0.3333333333333333
rsc_b_drop_factor:0.3333333333333333
save_model_every_checkpoint:False
schuse:False
schusech:cos
seed:0
split_style:strat
task:img_dg
tau:1
test_envs:[0]
output:../output/difexpacs/2-0/
weight_decay:0.0005
steps_per_epoch:100
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'office': ['amazon', 'dslr', 'webcam'], 'office-caltech': ['amazon', 'dslr', 'webcam', 'caltech'], 'office-home': ['Art', 'Clipart', 'Product', 'Real_World'], 'PACS': ['art_painting', 'cartoon', 'photo', 'sketch'], 'dg5': ['mnist', 'mnist_m', 'svhn', 'syn', 'usps'], 'VLCS': ['Caltech101', 'LabelMe', 'SUN09', 'VOC2007']}
input_shape:(3, 224, 224)
num_classes:7
domain_num:4

start training fft teacher net
epoch: 0, cls loss: 1.9712
epoch: 100, cls loss: 1.3477
epoch: 200, cls loss: 1.3153
epoch: 300, cls loss: 1.4315
epoch: 400, cls loss: 1.1008
epoch: 500, cls loss: 1.1356
epoch: 600, cls loss: 0.9212
epoch: 700, cls loss: 1.1072
epoch: 800, cls loss: 0.8147
epoch: 900, cls loss: 0.8876
epoch: 1000, cls loss: 1.1616
epoch: 1100, cls loss: 0.9212
epoch: 1200, cls loss: 1.0177
epoch: 1300, cls loss: 1.0755
epoch: 1400, cls loss: 0.8817
epoch: 1500, cls loss: 0.9839
epoch: 1600, cls loss: 0.8892
epoch: 1700, cls loss: 0.7999
epoch: 1800, cls loss: 0.7959
epoch: 1900, cls loss: 0.9253
epoch: 2000, cls loss: 0.9937
